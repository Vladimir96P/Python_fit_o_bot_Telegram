import telebot
from telebot import types
import statistics
import sqlite3
import os
import time
from datetime import datetime
bot = telebot.TeleBot("5058162485:AAHGx9-XieFGAaHLb3cVumTcokI1RkwGJbg")
@bot.message_handler(commands=['start'])
def send_welcome(message):
    msg = bot.reply_to(message, "–•—ç–π! –ú–µ–Ω—è –∑–æ–≤—É—Ç –§–∏—Ç–æ–±–æ—Çüòä –ê —Ç–µ–±—è –∫–∞–∫? –ù–∞–ø–∏—à–∏, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–≤–æ–µ –∏–º—è, –≤–æ–∑—Ä–∞—Å—Ç, —Ä–æ—Å—Ç –≤ –º–µ—Ç—Ä–∞—Ö –∏ –ø–æ–ª (—Ä—É—Å—Å–∫–æ—è–∑—ã—á–Ω–æ–π —Ä–∞—Å–∫–ª–∞–¥–∫–æ–π) –Ω–∞ –º–æ–µ–º –ø—Ä–∏–º–µ—Ä–µ: –§–∏—Ç–æ–±–æ—Ç 25 1.75 –ú")
    bot.register_next_step_handler(msg, user_name)
def send_keyboard(message, text = "–í—ã–±–µ—Ä–∏ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–π —Ä–∞–∑–¥–µ–ª üòâ"):
    keyboard = types.ReplyKeyboardMarkup(row_width=2)
    itembtn0 = types.KeyboardButton('–•–æ—á—É —Å–æ–æ–±—â–∏—Ç—å —Å–≤–æ–π —Ç–µ–∫—É—â–∏–π –≤–µ—Å üò±')
    itembtn1 = types.KeyboardButton('–•–æ—á—É –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Å–≤–æ–µ–≥–æ –≤–µ—Å–∞ üòà')
    itembtn2 = types.KeyboardButton('–•–æ—á—É —Å–æ–≥–Ω–∞—Ç—å –∂–∏—Ä–æ–∫ ü•¶')
    itembtn3 = types.KeyboardButton('–•–æ—á—É –ø–æ–¥–Ω–∞–±—Ä–∞—Ç—å –º–∞—Å—Å—ã üí™')
    itembtn4 = types.KeyboardButton('–£–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é –∑–∞–ø–∏—Å—å –≤–µ—Å–∞')
    itembtn5 = types.KeyboardButton("–£–¥–∞–ª–∏—Ç—å –≤—Å–µ –∑–∞–ø–∏—Å–∏")
    keyboard.add(itembtn0, itembtn1, itembtn2, itembtn3, itembtn4, itembtn5)
    msg = bot.send_message(message.from_user.id, text=text, reply_markup=keyboard)
    bot.register_next_step_handler(msg, callback_worker)
def user_name(msg):
    try:
        name = msg.text.split()[0].title()
        age = msg.text.split()[1]
        age = int(age)
        height = msg.text.split()[2]
        height = float(height)
        sex = msg.text.split()[3].title()
        if sex == '–ú' or sex == '–ñ':
            conn = sqlite3.connect('fit_o_bot.db')
            cursor = conn.cursor()
            try:
                query = '''CREATE TABLE IF NOT EXISTS bot_users_list (
                ID INTEGER UNIQUE PRIMARY KEY, 
                user_id INTEGER, 
                name TEXT,
                age INTEGER,
                height REAL,
                sex TEXT
                )'''
                cursor.execute(query)
                conn.close()
            except:
                bot.reply_to(message, '–ß—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –ø–æ *****')
            conn = sqlite3.connect('fit_o_bot.db')
            cursor = conn.cursor()
            with sqlite3.connect('fit_o_bot.db') as con:
                con.isolation_level = None
                cursor = con.cursor()
                cursor.execute('''
                       INSERT INTO bot_users_list (user_id, name, age, height, sex) 
                       VALUES (?, ?);''', (msg.from_user.id, name, age, height, sex))
                cursor.close()
            msg = bot.send_message(msg.from_user.id, f'''–ü—Ä–∏–≤–µ—Ç! –ü—Ä–∏—è—Ç–Ω–æ –ø–æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è, {name} üòú. –í—ã–±–∏—Ä–∞–π –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â—É—é —Ç–µ–±—è —Ç–µ–º—É:) –ò –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –Ω–µ –∑–∞–±—É–¥—å –≤–≤–µ—Å—Ç–∏ —Å–≤–æ–π —Ç–µ–∫—É—â–∏–π –≤–µ—Å!)''')
            send_keyboard(msg)
            bot.register_next_step_handler(msg, callback_worker)
        else:
            bot.reply_to(message, '–ö–∞–∂–µ—Ç—Å—è, –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤–≤–µ–¥–µ–Ω –ø–æ–ª')
    except Exception as e:
        bot.reply_to(message, '–ß—Ç–æ-—Ç–æ –Ω–µ —Ç–∞–∫.. –ø—Ä–æ–≤–µ—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –≤–≤–æ–¥–∞ –∏ –¥–∞–≤–∞–π –ø–æ–ø—Ä–æ–±—É–µ–º –µ—â–µ —Ä–∞–∑ üôè')
conn = sqlite3.connect('fit_o_bot.db')
cursor = conn.cursor()
try:
    query = '''CREATE TABLE IF NOT EXISTS bot_users_weights_table (
    ID INTEGER UNIQUE PRIMARY KEY, 
    user_id INTEGER, 
    date TEXT, 
    weight REAL
    )'''
    cursor.execute(query)
    conn.close()
except:
    pass
def add_weight(msg):
    current_date = msg.text.split()[0]
    current_weight = msg.text.split()[1]
    try:
        float(current_weight)
        current_weight = float(current_weight)
        dt_obj = dt.datetime.strptime(f"{current_date}", "%d-%m-%Y").date()
        with sqlite3.connect('fit_o_bot.db') as con:
            con.isolation_level = None
            cursor = con.cursor()
            cursor.execute('''
            INSERT INTO bot_users_weights_table (user_id, date, weight) 
            VALUES (?, ?, ?);''', (msg.from_user.id, current_date, current_weight))
            cursor.close()
            bot.send_message(msg.chat.id, '–ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–ª!üò® –ö–∞–∫ –∫–æ–≥–¥–∞-—Ç–æ —Å–∫–∞–∑–∞–ª –ê—Ä–∏—Å—Ç–æ—Ç–µ–ª—å: \"–ü–æ–∑–Ω–∞–Ω–∏–µ –≤—Å–µ–≥–¥–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å —É–¥–∏–≤–ª–µ–Ω–∏—è\"..')
            send_keyboard(msg)
    except:
        bot.send_message(msg.chat.id, '–í–≤–µ–¥–µ–Ω –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç üòü. –ü–æ–ø—Ä–æ–±—É–π –µ—â–µ —Ä–∞–∑ üòâ')
        send_keyboard(msg)
def get_nice(data_list):
    data_str = []
    for val in list(data_list):
        data_str.append(f'{val[0]} = {val[1]} –∫–≥\n')
    return ''.join(data_str)
def weight_statistic(msg):
    with sqlite3.connect('fit_o_bot.db') as con:
        con.isolation_level = None
        cursor = con.cursor()
        cursor.execute(f'SELECT date, weight FROM bot_users_weights_table WHERE user_id=={msg.from_user.id}')
        c = cursor.fetchall()
        data_list = get_nice(c)
        bot.send_message(msg.chat.id, data_list)
        send_keyboard(msg, "–û—Ö! –°–Ω–∞—á–∞–ª–∞ –ø–æ–¥—É–º–∞–ª, —á—Ç–æ —ç—Ç–æ –ø—Ä–∏–º–µ—Ä –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–∏, –∞ –æ–∫–∞–∑–∞–ª–æ—Å—å..")
def pretiffy(last_val):
    for val in last_val:
        last_v = val[0]
        return last_v
def decrease_weight(call):
    if call.text == "–ù–∏–∑–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å üêå":
        with sqlite3.connect('fit_o_bot.db') as con:
            con.isolation_level = None
            cursor = con.cursor()
            cursor.execute(f'SELECT weight FROM bot_users_weights_table WHERE user_id=={msg.from_user.id} ORDER BY ID DESC LIMIT 1')
            last_weight = float(pretiffy(cursor.fetchall()))
            cursor.execute(f'SELECT sex FROM bot_users_list WHERE user_id=={msg.from_user.id} ORDER BY ID DESC LIMIT 1')
            sex = pretiffy(cursor.fetchall())
            cursor.execute(f'SELECT age FROM bot_users_list WHERE user_id=={msg.from_user.id} ORDER BY ID DESC LIMIT 1')
            age = int(pretiffy(cursor.fetchall()))
            cursor.execute(f'SELECT height FROM bot_users_list WHERE user_id=={msg.from_user.id} ORDER BY ID DESC LIMIT 1')
            height = float(pretiffy(cursor.fetchall()))
            if sex == '–ú':
                target_calories = round(0.8 * (13.397 * last_weight + 88.362 + 4.799 * height * 100 - 5.677 * age))
                water_quantity = round(((target_calories/ 1000) * 1),2)
                fat_nutrient = round((0.35 * target_calories) / 9)
                protein_nutrient = round((0.25 * target_calories) / 4)
                carbs_nutrient = round((0.4 * target_calories) / 4)
                bot.send_message(msg.chat.id, f'''
                –¢–∞–∫—Å ü§î, —Å—É–¥—è –ø–æ –∏–º–µ—é—â–∏–º—Å—è —É –º–µ–Ω—è –¥–∞–Ω–Ω—ã–º —Ç–≤–æ–π —Ç–µ–∫—É—â–∏–π –∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–ø–∏—Å–∞–Ω–Ω—ã–π –≤–µ—Å —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç {last_weight} –∫–≥. –†–æ—Å—Ç = {height} –º; –í–æ–∑—Ä–∞—Å—Ç = {age}; –ü–æ–ª: {sex}.
                \n–ï—Å–ª–∏ —ç—Ç–æ –Ω–µ —Ç–∞–∫ - —Ç–µ–±–µ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –∫–æ–º–∞–Ω–¥–∞—Ö, –∏–Ω–∞—á–µ —Ä–∞—Å—á–µ—Ç –±—É–¥–µ—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º üòî.
                \n–î–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–∏ —Ç–µ–±–µ —Å–ª–µ–¥—É–µ—Ç –ø—Ä–∏–¥–µ—Ä–∂–∏–≤–∞—Ç—å—Å—è —Å–ª–µ–¥—É—é—â–∏—Ö –µ–∂–µ—Å—É—Ç–æ—á–Ω—ã—Ö –ø—Ä–æ–ø–æ—Ä—Ü–∏–π –≤ –ø–∏—Ç–∞–Ω–∏–∏:
                \n- {fat_nutrient} –≥ –∂–∏—Ä–æ–≤;
                \n- {protein_nutrient} –≥ –±–µ–ª–∫–æ–≤;
                \n- {carbs_nutrient} –≥ —É–≥–ª–µ–≤–æ–¥–æ–≤.
                \n- –ê —Ç–∞–∫–∂–µ –≤—ã–ø–∏–≤–∞—Ç—å –Ω–µ –º–µ–Ω—å—à–µ, —á–µ–º {water_quantity} –ª —á–∏—Å—Ç–æ–π –≤–æ–¥—ã!
                \n–ò—Ç–æ–≥–æ —Ç–≤–æ–π —Å—É–º–º–∞—Ä–Ω—ã–π —Ä–∞—Ü–∏–æ–Ω –∑–∞ –¥–µ–Ω—å —Å–æ—Å—Ç–∞–≤–∏—Ç {target_calories} –∫–∫–∞–ª.
                \n–î–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ –∏ –∑–∞–ø–∏—Å–∏ –±—É–¥—É—Ç –æ—á–µ–Ω—å –ø–æ–ª–µ–∑–Ω—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∞ —Ç–∞–∫–∂–µ –∫—É—Ö–æ–Ω–Ω—ã–µ –≤–µ—Å—ã. –ù–µ –∑–∞–±—ã–≤–∞–π, —á—Ç–æ –∑–∞—á–∞—Å—Ç—É—é –∫–∞–ª–ª–æ—Ä–∏–π–Ω–æ—Å—Ç—å –ø—Ä–æ–¥—É–∫—Ç–∞ —É–∫–∞–∑–∞–Ω–∞ –Ω–∞ —Å—É—Ö–æ–π (–Ω–µ –≥–æ—Ç–æ–≤—ã–π) –ø—Ä–æ–¥—É–∫—Ç. –ü–æ—ç—Ç–æ–º—É –≤–∑–≤–µ—à–∏–≤–∞—Ç—å –≤—Å–µ –ø—Ä–æ—â–µ –¥–æ –≥–æ—Ç–æ–≤–∫–∏. –£–≥–ª–µ–≤–æ–¥—ã –ø–æ—Å—Ç–∞—Ä–∞–π—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–µ, –∞ –∂–∏—Ä—ã - –ø–æ–ª–µ–∑–Ω—ã–µ. 
                \n–ü–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ —Ü–µ–ª–µ–≤–æ–≥–æ –≤–µ—Å–∞, –º–æ–∂–µ—à—å –æ–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏ —è –ø—Ä–æ–∏–∑–≤–µ–¥—É –ø–µ—Ä–µ—Ä–∞—Å—á–µ—Ç –ø–æ–¥ –Ω–æ–≤—É—é —Ü–µ–ª—å. 
                \n–£–¥–∞—á–∏! –í—Å–µ –ø–æ–ª—É—á–∏—Ç—Å—è ‚ò∫Ô∏è
                ''')
                cursor.close()
                send_keyboard(msg)
            elif sex == '–ñ':
                target_calories = round(0.8 * (9.247 * last_weight + 447.593 + 3.098 * height * 100 - 4.33 * age))
                water_quantity = round(((target_calories / 1000) * 1), 2)
                fat_nutrient = round((0.35 * target_calories) / 9)
                protein_nutrient = round((0.25 * target_calories) / 4)
                carbs_nutrient = round((0.4 * target_calories) / 4)
                bot.send_message(msg.chat.id, f'''
                –¢–∞–∫—Å ü§î, —Å—É–¥—è –ø–æ –∏–º–µ—é—â–∏–º—Å—è —É –º–µ–Ω—è –¥–∞–Ω–Ω—ã–º —Ç–≤–æ–π —Ç–µ–∫—É—â–∏–π –∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–ø–∏—Å–∞–Ω–Ω—ã–π –≤–µ—Å —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç {last_weight} –∫–≥. –†–æ—Å—Ç = {height} –º; –í–æ–∑—Ä–∞—Å—Ç = {age}; –ü–æ–ª: {sex}.
                \n–ï—Å–ª–∏ —ç—Ç–æ –Ω–µ —Ç–∞–∫ - —Ç–µ–±–µ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –∫–æ–º–∞–Ω–¥–∞—Ö, –∏–Ω–∞—á–µ —Ä–∞—Å—á–µ—Ç –±—É–¥–µ—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º üòî.
                \n–î–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–∏ —Ç–µ–±–µ —Å–ª–µ–¥—É–µ—Ç –ø—Ä–∏–¥–µ—Ä–∂–∏–≤–∞—Ç—å—Å—è —Å–ª–µ–¥—É—é—â–∏—Ö –µ–∂–µ—Å—É—Ç–æ—á–Ω—ã—Ö –ø—Ä–æ–ø–æ—Ä—Ü–∏–π –≤ –ø–∏—Ç–∞–Ω–∏–∏:
                \n- {fat_nutrient} –≥ –∂–∏—Ä–æ–≤;
                \n- {protein_nutrient} –≥ –±–µ–ª–∫–æ–≤;
                \n- {carbs_nutrient} –≥ —É–≥–ª–µ–≤–æ–¥–æ–≤.
                \n- –ê —Ç–∞–∫–∂–µ –≤—ã–ø–∏–≤–∞—Ç—å –Ω–µ –º–µ–Ω—å—à–µ, —á–µ–º {water_quantity} –ª —á–∏—Å—Ç–æ–π –≤–æ–¥—ã!
                \n–ò—Ç–æ–≥–æ —Ç–≤–æ–π —Å—É–º–º–∞—Ä–Ω—ã–π —Ä–∞—Ü–∏–æ–Ω –∑–∞ –¥–µ–Ω—å —Å–æ—Å—Ç–∞–≤–∏—Ç {target_calories} –∫–∫–∞–ª.
                \n–î–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ –∏ –∑–∞–ø–∏—Å–∏ –±—É–¥—É—Ç –æ—á–µ–Ω—å –ø–æ–ª–µ–∑–Ω—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∞ —Ç–∞–∫–∂–µ –∫—É—Ö–æ–Ω–Ω—ã–µ –≤–µ—Å—ã. –ù–µ –∑–∞–±—ã–≤–∞–π, —á—Ç–æ –∑–∞—á–∞—Å—Ç—É—é –∫–∞–ª–ª–æ—Ä–∏–π–Ω–æ—Å—Ç—å –ø—Ä–æ–¥—É–∫—Ç–∞ —É–∫–∞–∑–∞–Ω–∞ –Ω–∞ —Å—É—Ö–æ–π (–Ω–µ –≥–æ—Ç–æ–≤—ã–π) –ø—Ä–æ–¥—É–∫—Ç. –ü–æ—ç—Ç–æ–º—É –≤–∑–≤–µ—à–∏–≤–∞—Ç—å –≤—Å–µ –ø—Ä–æ—â–µ –¥–æ –≥–æ—Ç–æ–≤–∫–∏. –£–≥–ª–µ–≤–æ–¥—ã –ø–æ—Å—Ç–∞—Ä–∞–π—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–µ, –∞ –∂–∏—Ä—ã - –ø–æ–ª–µ–∑–Ω—ã–µ. 
                \n–ü–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ —Ü–µ–ª–µ–≤–æ–≥–æ –≤–µ—Å–∞, –º–æ–∂–µ—à—å –æ–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏ —è –ø—Ä–æ–∏–∑–≤–µ–¥—É –ø–µ—Ä–µ—Ä–∞—Å—á–µ—Ç –ø–æ–¥ –Ω–æ–≤—É—é —Ü–µ–ª—å. 
                \n–£–¥–∞—á–∏! –í—Å–µ –ø–æ–ª—É—á–∏—Ç—Å—è ‚ò∫Ô∏è
                ''')
                cursor.close()
                send_keyboard(msg)
    elif call.text == "–°—Ä–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å üèÑ‚Äç‚ôÄÔ∏èüèÑ‚Äç‚ôÇÔ∏è":
        with sqlite3.connect('fit_o_bot.db') as con:
            con.isolation_level = None
            cursor = con.cursor()
            cursor.execute(f'SELECT weight FROM bot_users_weights_table WHERE user_id=={msg.from_user.id} ORDER BY ID DESC LIMIT 1')
            last_weight = float(pretiffy(cursor.fetchall()))
            cursor.execute(f'SELECT sex FROM bot_users_list WHERE user_id=={msg.from_user.id} ORDER BY ID DESC LIMIT 1')
            sex = pretiffy(cursor.fetchall())
            cursor.execute(f'SELECT age FROM bot_users_list WHERE user_id=={msg.from_user.id} ORDER BY ID DESC LIMIT 1')
            age = int(pretiffy(cursor.fetchall()))
            cursor.execute(f'SELECT height FROM bot_users_list WHERE user_id=={msg.from_user.id} ORDER BY ID DESC LIMIT 1')
            height = float(pretiffy(cursor.fetchall()))
            if sex == '–ú':
                target_calories = round(0.85 * (13.397 * last_weight + 88.362 + 4.799 * height * 100 - 5.677 * age))
                water_quantity = round(((target_calories/ 1000) * 1),2)
                fat_nutrient = round((0.35 * target_calories) / 9)
                protein_nutrient = round((0.25 * target_calories) / 4)
                carbs_nutrient = round((0.4 * target_calories) / 4)
                bot.send_message(msg.chat.id, f'''
                –¢–∞–∫—Å ü§î, —Å—É–¥—è –ø–æ –∏–º–µ—é—â–∏–º—Å—è —É –º–µ–Ω—è –¥–∞–Ω–Ω—ã–º —Ç–≤–æ–π —Ç–µ–∫—É—â–∏–π –∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–ø–∏—Å–∞–Ω–Ω—ã–π –≤–µ—Å —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç {last_weight} –∫–≥. –†–æ—Å—Ç = {height} –º; –í–æ–∑—Ä–∞—Å—Ç = {age}; –ü–æ–ª: {sex}.
                \n–ï—Å–ª–∏ —ç—Ç–æ –Ω–µ —Ç–∞–∫ - —Ç–µ–±–µ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –∫–æ–º–∞–Ω–¥–∞—Ö, –∏–Ω–∞—á–µ —Ä–∞—Å—á–µ—Ç –±—É–¥–µ—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º üòî.
                \n–î–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–∏ —Ç–µ–±–µ —Å–ª–µ–¥—É–µ—Ç –ø—Ä–∏–¥–µ—Ä–∂–∏–≤–∞—Ç—å—Å—è —Å–ª–µ–¥—É—é—â–∏—Ö –µ–∂–µ—Å—É—Ç–æ—á–Ω—ã—Ö –ø—Ä–æ–ø–æ—Ä—Ü–∏–π –≤ –ø–∏—Ç–∞–Ω–∏–∏:
                \n- {fat_nutrient} –≥ –∂–∏—Ä–æ–≤;
                \n- {protein_nutrient} –≥ –±–µ–ª–∫–æ–≤;
                \n- {carbs_nutrient} –≥ —É–≥–ª–µ–≤–æ–¥–æ–≤.
                \n- –ê —Ç–∞–∫–∂–µ –≤—ã–ø–∏–≤–∞—Ç—å –Ω–µ –º–µ–Ω—å—à–µ, —á–µ–º {water_quantity} –ª —á–∏—Å—Ç–æ–π –≤–æ–¥—ã!
                \n–ò—Ç–æ–≥–æ —Ç–≤–æ–π —Å—É–º–º–∞—Ä–Ω—ã–π —Ä–∞—Ü–∏–æ–Ω –∑–∞ –¥–µ–Ω—å —Å–æ—Å—Ç–∞–≤–∏—Ç {target_calories} –∫–∫–∞–ª.
                \n–î–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ –∏ –∑–∞–ø–∏—Å–∏ –±—É–¥—É—Ç –æ—á–µ–Ω—å –ø–æ–ª–µ–∑–Ω—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∞ —Ç–∞–∫–∂–µ –∫—É—Ö–æ–Ω–Ω—ã–µ –≤–µ—Å—ã. –ù–µ –∑–∞–±—ã–≤–∞–π, —á—Ç–æ –∑–∞—á–∞—Å—Ç—É—é –∫–∞–ª–ª–æ—Ä–∏–π–Ω–æ—Å—Ç—å –ø—Ä–æ–¥—É–∫—Ç–∞ —É–∫–∞–∑–∞–Ω–∞ –Ω–∞ —Å—É—Ö–æ–π (–Ω–µ –≥–æ—Ç–æ–≤—ã–π) –ø—Ä–æ–¥—É–∫—Ç. –ü–æ—ç—Ç–æ–º—É –≤–∑–≤–µ—à–∏–≤–∞—Ç—å –≤—Å–µ –ø—Ä–æ—â–µ –¥–æ –≥–æ—Ç–æ–≤–∫–∏. –£–≥–ª–µ–≤–æ–¥—ã –ø–æ—Å—Ç–∞—Ä–∞–π—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–µ, –∞ –∂–∏—Ä—ã - –ø–æ–ª–µ–∑–Ω—ã–µ. 
                \n–ü–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ —Ü–µ–ª–µ–≤–æ–≥–æ –≤–µ—Å–∞, –º–æ–∂–µ—à—å –æ–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏ —è –ø—Ä–æ–∏–∑–≤–µ–¥—É –ø–µ—Ä–µ—Ä–∞—Å—á–µ—Ç –ø–æ–¥ –Ω–æ–≤—É—é —Ü–µ–ª—å. 
                \n–£–¥–∞—á–∏! –í—Å–µ –ø–æ–ª—É—á–∏—Ç—Å—è ‚ò∫Ô∏è
                ''')
                cursor.close()
                send_keyboard(msg)
            elif sex == '–ñ':
                target_calories = round(0.85 * (9.247 * last_weight + 447.593 + 3.098 * height * 100 - 4.33 * age))
                water_quantity = round(((target_calories / 1000) * 1), 2)
                fat_nutrient = round((0.35 * target_calories) / 9)
                protein_nutrient = round((0.25 * target_calories) / 4)
                carbs_nutrient = round((0.4 * target_calories) / 4)
                bot.send_message(msg.chat.id, f'''
                –¢–∞–∫—Å ü§î, —Å—É–¥—è –ø–æ –∏–º–µ—é—â–∏–º—Å—è —É –º–µ–Ω—è –¥–∞–Ω–Ω—ã–º —Ç–≤–æ–π —Ç–µ–∫—É—â–∏–π –∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–ø–∏—Å–∞–Ω–Ω—ã–π –≤–µ—Å —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç {last_weight} –∫–≥. –†–æ—Å—Ç = {height} –º; –í–æ–∑—Ä–∞—Å—Ç = {age}; –ü–æ–ª: {sex}.
                \n–ï—Å–ª–∏ —ç—Ç–æ –Ω–µ —Ç–∞–∫ - —Ç–µ–±–µ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –∫–æ–º–∞–Ω–¥–∞—Ö, –∏–Ω–∞—á–µ —Ä–∞—Å—á–µ—Ç –±—É–¥–µ—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º üòî.
                \n–î–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–∏ —Ç–µ–±–µ —Å–ª–µ–¥—É–µ—Ç –ø—Ä–∏–¥–µ—Ä–∂–∏–≤–∞—Ç—å—Å—è —Å–ª–µ–¥—É—é—â–∏—Ö –µ–∂–µ—Å—É—Ç–æ—á–Ω—ã—Ö –ø—Ä–æ–ø–æ—Ä—Ü–∏–π –≤ –ø–∏—Ç–∞–Ω–∏–∏:
                \n- {fat_nutrient} –≥ –∂–∏—Ä–æ–≤;
                \n- {protein_nutrient} –≥ –±–µ–ª–∫–æ–≤;
                \n- {carbs_nutrient} –≥ —É–≥–ª–µ–≤–æ–¥–æ–≤.
                \n- –ê —Ç–∞–∫–∂–µ –≤—ã–ø–∏–≤–∞—Ç—å –Ω–µ –º–µ–Ω—å—à–µ, —á–µ–º {water_quantity} –ª —á–∏—Å—Ç–æ–π –≤–æ–¥—ã!
                \n–ò—Ç–æ–≥–æ —Ç–≤–æ–π —Å—É–º–º–∞—Ä–Ω—ã–π —Ä–∞—Ü–∏–æ–Ω –∑–∞ –¥–µ–Ω—å —Å–æ—Å—Ç–∞–≤–∏—Ç {target_calories} –∫–∫–∞–ª.
                \n–î–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ –∏ –∑–∞–ø–∏—Å–∏ –±—É–¥—É—Ç –æ—á–µ–Ω—å –ø–æ–ª–µ–∑–Ω—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∞ —Ç–∞–∫–∂–µ –∫—É—Ö–æ–Ω–Ω—ã–µ –≤–µ—Å—ã. –ù–µ –∑–∞–±—ã–≤–∞–π, —á—Ç–æ –∑–∞—á–∞—Å—Ç—É—é –∫–∞–ª–ª–æ—Ä–∏–π–Ω–æ—Å—Ç—å –ø—Ä–æ–¥—É–∫—Ç–∞ —É–∫–∞–∑–∞–Ω–∞ –Ω–∞ —Å—É—Ö–æ–π (–Ω–µ –≥–æ—Ç–æ–≤—ã–π) –ø—Ä–æ–¥—É–∫—Ç. –ü–æ—ç—Ç–æ–º—É –≤–∑–≤–µ—à–∏–≤–∞—Ç—å –≤—Å–µ –ø—Ä–æ—â–µ –¥–æ –≥–æ—Ç–æ–≤–∫–∏. –£–≥–ª–µ–≤–æ–¥—ã –ø–æ—Å—Ç–∞—Ä–∞–π—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–µ, –∞ –∂–∏—Ä—ã - –ø–æ–ª–µ–∑–Ω—ã–µ. 
                \n–ü–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ —Ü–µ–ª–µ–≤–æ–≥–æ –≤–µ—Å–∞, –º–æ–∂–µ—à—å –æ–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏ —è –ø—Ä–æ–∏–∑–≤–µ–¥—É –ø–µ—Ä–µ—Ä–∞—Å—á–µ—Ç –ø–æ–¥ –Ω–æ–≤—É—é —Ü–µ–ª—å. 
                \n–£–¥–∞—á–∏! –í—Å–µ –ø–æ–ª—É—á–∏—Ç—Å—è ‚ò∫Ô∏è
                ''')
                cursor.close()
                send_keyboard(msg)
    elif call.text == "–í—ã—Å–æ–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å üèãÔ∏è‚Äç‚ôÇÔ∏è üî• üèãÔ∏è‚ÄçÔ∏è":
        with sqlite3.connect('fit_o_bot.db') as con:
            con.isolation_level = None
            cursor = con.cursor()
            cursor.execute(f'SELECT weight FROM bot_users_weights_table WHERE user_id=={msg.from_user.id} ORDER BY ID DESC LIMIT 1')
            last_weight = float(pretiffy(cursor.fetchall()))
            cursor.execute(f'SELECT sex FROM bot_users_list WHERE user_id=={msg.from_user.id} ORDER BY ID DESC LIMIT 1')
            sex = pretiffy(cursor.fetchall())
            cursor.execute(f'SELECT age FROM bot_users_list WHERE user_id=={msg.from_user.id} ORDER BY ID DESC LIMIT 1')
            age = int(pretiffy(cursor.fetchall()))
            cursor.execute(f'SELECT height FROM bot_users_list WHERE user_id=={msg.from_user.id} ORDER BY ID DESC LIMIT 1')
            height = float(pretiffy(cursor.fetchall()))
            if sex == '–ú':
                target_calories = round(0.9 * (13.397 * last_weight + 88.362 + 4.799 * height * 100 - 5.677 * age))
                water_quantity = round(((target_calories/ 1000) * 1),2)
                fat_nutrient = round((0.35 * target_calories) / 9)
                protein_nutrient = round((0.4 * target_calories) / 4)
                carbs_nutrient = round((0.25 * target_calories) / 4)
                bot.send_message(msg.chat.id, f'''
                –¢–∞–∫—Å ü§î, —Å—É–¥—è –ø–æ –∏–º–µ—é—â–∏–º—Å—è —É –º–µ–Ω—è –¥–∞–Ω–Ω—ã–º —Ç–≤–æ–π —Ç–µ–∫—É—â–∏–π –∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–ø–∏—Å–∞–Ω–Ω—ã–π –≤–µ—Å —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç {last_weight} –∫–≥. –†–æ—Å—Ç = {height} –º; –í–æ–∑—Ä–∞—Å—Ç = {age}; –ü–æ–ª: {sex}.
                \n–ï—Å–ª–∏ —ç—Ç–æ –Ω–µ —Ç–∞–∫ - —Ç–µ–±–µ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –∫–æ–º–∞–Ω–¥–∞—Ö, –∏–Ω–∞—á–µ —Ä–∞—Å—á–µ—Ç –±—É–¥–µ—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º üòî.
                \n–î–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–∏ —Ç–µ–±–µ —Å–ª–µ–¥—É–µ—Ç –ø—Ä–∏–¥–µ—Ä–∂–∏–≤–∞—Ç—å—Å—è —Å–ª–µ–¥—É—é—â–∏—Ö –µ–∂–µ—Å—É—Ç–æ—á–Ω—ã—Ö –ø—Ä–æ–ø–æ—Ä—Ü–∏–π –≤ –ø–∏—Ç–∞–Ω–∏–∏:
                \n- {fat_nutrient} –≥ –∂–∏—Ä–æ–≤;
                \n- {protein_nutrient} –≥ –±–µ–ª–∫–æ–≤;
                \n- {carbs_nutrient} –≥ —É–≥–ª–µ–≤–æ–¥–æ–≤.
                \n- –ê —Ç–∞–∫–∂–µ –≤—ã–ø–∏–≤–∞—Ç—å –Ω–µ –º–µ–Ω—å—à–µ, —á–µ–º {water_quantity} –ª —á–∏—Å—Ç–æ–π –≤–æ–¥—ã!
                \n–ò—Ç–æ–≥–æ —Ç–≤–æ–π —Å—É–º–º–∞—Ä–Ω—ã–π —Ä–∞—Ü–∏–æ–Ω –∑–∞ –¥–µ–Ω—å —Å–æ—Å—Ç–∞–≤–∏—Ç {target_calories} –∫–∫–∞–ª.
                \n–î–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ –∏ –∑–∞–ø–∏—Å–∏ –±—É–¥—É—Ç –æ—á–µ–Ω—å –ø–æ–ª–µ–∑–Ω—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∞ —Ç–∞–∫–∂–µ –∫—É—Ö–æ–Ω–Ω—ã–µ –≤–µ—Å—ã. –ù–µ –∑–∞–±—ã–≤–∞–π, —á—Ç–æ –∑–∞—á–∞—Å—Ç—É—é –∫–∞–ª–ª–æ—Ä–∏–π–Ω–æ—Å—Ç—å –ø—Ä–æ–¥—É–∫—Ç–∞ —É–∫–∞–∑–∞–Ω–∞ –Ω–∞ —Å—É—Ö–æ–π (–Ω–µ –≥–æ—Ç–æ–≤—ã–π) –ø—Ä–æ–¥—É–∫—Ç. –ü–æ—ç—Ç–æ–º—É –≤–∑–≤–µ—à–∏–≤–∞—Ç—å –≤—Å–µ –ø—Ä–æ—â–µ –¥–æ –≥–æ—Ç–æ–≤–∫–∏. –£–≥–ª–µ–≤–æ–¥—ã –ø–æ—Å—Ç–∞—Ä–∞–π—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–µ, –∞ –∂–∏—Ä—ã - –ø–æ–ª–µ–∑–Ω—ã–µ. 
                \n–ü–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ —Ü–µ–ª–µ–≤–æ–≥–æ –≤–µ—Å–∞, –º–æ–∂–µ—à—å –æ–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏ —è –ø—Ä–æ–∏–∑–≤–µ–¥—É –ø–µ—Ä–µ—Ä–∞—Å—á–µ—Ç –ø–æ–¥ –Ω–æ–≤—É—é —Ü–µ–ª—å. 
                \n–£–¥–∞—á–∏! –í—Å–µ –ø–æ–ª—É—á–∏—Ç—Å—è ‚ò∫Ô∏è
                ''')
                cursor.close()
                send_keyboard(msg)
            elif sex == '–ñ':
                target_calories = round(0.9 * (9.247 * last_weight + 447.593 + 3.098 * height * 100 - 4.33 * age))
                water_quantity = round(((target_calories / 1000) * 1), 2)
                fat_nutrient = round((0.35 * target_calories) / 9)
                protein_nutrient = round((0.4 * target_calories) / 4)
                carbs_nutrient = round((0.25 * target_calories) / 4)
                bot.send_message(msg.chat.id, f'''
                –¢–∞–∫—Å ü§î, —Å—É–¥—è –ø–æ –∏–º–µ—é—â–∏–º—Å—è —É –º–µ–Ω—è –¥–∞–Ω–Ω—ã–º —Ç–≤–æ–π —Ç–µ–∫—É—â–∏–π –∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–ø–∏—Å–∞–Ω–Ω—ã–π –≤–µ—Å —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç {last_weight} –∫–≥. –†–æ—Å—Ç = {height} –º; –í–æ–∑—Ä–∞—Å—Ç = {age}; –ü–æ–ª: {sex}.
                \n–ï—Å–ª–∏ —ç—Ç–æ –Ω–µ —Ç–∞–∫ - —Ç–µ–±–µ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –∫–æ–º–∞–Ω–¥–∞—Ö, –∏–Ω–∞—á–µ —Ä–∞—Å—á–µ—Ç –±—É–¥–µ—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º üòî.
                \n–î–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–∏ —Ç–µ–±–µ —Å–ª–µ–¥—É–µ—Ç –ø—Ä–∏–¥–µ—Ä–∂–∏–≤–∞—Ç—å—Å—è —Å–ª–µ–¥—É—é—â–∏—Ö –µ–∂–µ—Å—É—Ç–æ—á–Ω—ã—Ö –ø—Ä–æ–ø–æ—Ä—Ü–∏–π –≤ –ø–∏—Ç–∞–Ω–∏–∏:
                \n- {fat_nutrient} –≥ –∂–∏—Ä–æ–≤;
                \n- {protein_nutrient} –≥ –±–µ–ª–∫–æ–≤;
                \n- {carbs_nutrient} –≥ —É–≥–ª–µ–≤–æ–¥–æ–≤.
                \n- –ê —Ç–∞–∫–∂–µ –≤—ã–ø–∏–≤–∞—Ç—å –Ω–µ –º–µ–Ω—å—à–µ, —á–µ–º {water_quantity} –ª —á–∏—Å—Ç–æ–π –≤–æ–¥—ã!
                \n–ò—Ç–æ–≥–æ —Ç–≤–æ–π —Å—É–º–º–∞—Ä–Ω—ã–π —Ä–∞—Ü–∏–æ–Ω –∑–∞ –¥–µ–Ω—å —Å–æ—Å—Ç–∞–≤–∏—Ç {target_calories} –∫–∫–∞–ª.
                \n–î–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ –∏ –∑–∞–ø–∏—Å–∏ –±—É–¥—É—Ç –æ—á–µ–Ω—å –ø–æ–ª–µ–∑–Ω—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∞ —Ç–∞–∫–∂–µ –∫—É—Ö–æ–Ω–Ω—ã–µ –≤–µ—Å—ã. –ù–µ –∑–∞–±—ã–≤–∞–π, —á—Ç–æ –∑–∞—á–∞—Å—Ç—É—é –∫–∞–ª–ª–æ—Ä–∏–π–Ω–æ—Å—Ç—å –ø—Ä–æ–¥—É–∫—Ç–∞ —É–∫–∞–∑–∞–Ω–∞ –Ω–∞ —Å—É—Ö–æ–π (–Ω–µ –≥–æ—Ç–æ–≤—ã–π) –ø—Ä–æ–¥—É–∫—Ç. –ü–æ—ç—Ç–æ–º—É –≤–∑–≤–µ—à–∏–≤–∞—Ç—å –≤—Å–µ –ø—Ä–æ—â–µ –¥–æ –≥–æ—Ç–æ–≤–∫–∏. –£–≥–ª–µ–≤–æ–¥—ã –ø–æ—Å—Ç–∞—Ä–∞–π—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–µ, –∞ –∂–∏—Ä—ã - –ø–æ–ª–µ–∑–Ω—ã–µ. 
                \n–ü–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ —Ü–µ–ª–µ–≤–æ–≥–æ –≤–µ—Å–∞, –º–æ–∂–µ—à—å –æ–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏ —è –ø—Ä–æ–∏–∑–≤–µ–¥—É –ø–µ—Ä–µ—Ä–∞—Å—á–µ—Ç –ø–æ–¥ –Ω–æ–≤—É—é —Ü–µ–ª—å. 
                \n–£–¥–∞—á–∏! –í—Å–µ –ø–æ–ª—É—á–∏—Ç—Å—è ‚ò∫Ô∏è
                ''')
                cursor.close()
                send_keyboard(msg)
def increase_weight(call):
    if call.text == "–ù–∏–∑–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å üêå":
        bot.send_message(msg.chat.id, '''
        –Ø –¥–∞–∂–µ –±–æ—é—Å—å –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å, –∫–∞–∫–∞—è —É —Ç–µ–±—è —Ü–µ–ª—å –Ω–∞–±–æ—Ä–∞ –ø—Ä–∏ –º–∞–ª–æ–∞–∫—Ç–∏–≤–Ω–æ–º –æ–±—Ä–∞–∑–µ –∂–∏–∑–Ω–∏ üò±! –ù–æ —ç—Ç–æ —Ç–æ—á–Ω–æ –Ω–µ –≤ —Ä–∞–º–∫–∞—Ö –º–æ–∏—Ö –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–π üòÇ
        ''')
        send_keyboard(msg)
    elif call.text == "–°—Ä–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å üèÑ‚Äç‚ôÄÔ∏èüèÑ‚Äç‚ôÇ":
        with sqlite3.connect('fit_o_bot.db') as con:
            con.isolation_level = None
            cursor = con.cursor()
            cursor.execute(f'SELECT weight FROM bot_users_weights_table WHERE user_id=={msg.from_user.id} ORDER BY ID DESC LIMIT 1')
            last_weight = float(pretiffy(cursor.fetchall()))
            cursor.execute(f'SELECT sex FROM bot_users_list WHERE user_id=={msg.from_user.id} ORDER BY ID DESC LIMIT 1')
            sex = pretiffy(cursor.fetchall())
            cursor.execute(f'SELECT age FROM bot_users_list WHERE user_id=={msg.from_user.id} ORDER BY ID DESC LIMIT 1')
            age = int(pretiffy(cursor.fetchall()))
            cursor.execute(f'SELECT height FROM bot_users_list WHERE user_id=={msg.from_user.id} ORDER BY ID DESC LIMIT 1')
            height = float(pretiffy(cursor.fetchall()))
            if sex == '–ú':
                target_calories = round(1.2 * (13.397 * last_weight + 88.362 + 4.799 * height * 100 - 5.677 * age))
                water_quantity = round(((target_calories/ 1000) * 1),2)
                fat_nutrient = round((0.35 * target_calories) / 9)
                protein_nutrient = round((0.25 * target_calories) / 4)
                carbs_nutrient = round((0.4 * target_calories) / 4)
                bot.send_message(msg.chat.id, f'''
                –¢–∞–∫—Å ü§î, —Å—É–¥—è –ø–æ –∏–º–µ—é—â–∏–º—Å—è —É –º–µ–Ω—è –¥–∞–Ω–Ω—ã–º —Ç–≤–æ–π —Ç–µ–∫—É—â–∏–π –∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–ø–∏—Å–∞–Ω–Ω—ã–π –≤–µ—Å —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç {last_weight} –∫–≥. –†–æ—Å—Ç = {height} –º; –í–æ–∑—Ä–∞—Å—Ç = {age}; –ü–æ–ª: {sex}.
                \n–ï—Å–ª–∏ —ç—Ç–æ –Ω–µ —Ç–∞–∫ - —Ç–µ–±–µ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –∫–æ–º–∞–Ω–¥–∞—Ö, –∏–Ω–∞—á–µ —Ä–∞—Å—á–µ—Ç –±—É–¥–µ—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º üòî.
                \n–î–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–∏ —Ç–µ–±–µ —Å–ª–µ–¥—É–µ—Ç –ø—Ä–∏–¥–µ—Ä–∂–∏–≤–∞—Ç—å—Å—è —Å–ª–µ–¥—É—é—â–∏—Ö –µ–∂–µ—Å—É—Ç–æ—á–Ω—ã—Ö –ø—Ä–æ–ø–æ—Ä—Ü–∏–π –≤ –ø–∏—Ç–∞–Ω–∏–∏:
                \n- {fat_nutrient} –≥ –∂–∏—Ä–æ–≤;
                \n- {protein_nutrient} –≥ –±–µ–ª–∫–æ–≤;
                \n- {carbs_nutrient} –≥ —É–≥–ª–µ–≤–æ–¥–æ–≤.
                \n- –ê —Ç–∞–∫–∂–µ –≤—ã–ø–∏–≤–∞—Ç—å –Ω–µ –º–µ–Ω—å—à–µ, —á–µ–º {water_quantity} –ª —á–∏—Å—Ç–æ–π –≤–æ–¥—ã!
                \n–ò—Ç–æ–≥–æ —Ç–≤–æ–π —Å—É–º–º–∞—Ä–Ω—ã–π —Ä–∞—Ü–∏–æ–Ω –∑–∞ –¥–µ–Ω—å —Å–æ—Å—Ç–∞–≤–∏—Ç {target_calories} –∫–∫–∞–ª.
                \n–î–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ –∏ –∑–∞–ø–∏—Å–∏ –±—É–¥—É—Ç –æ—á–µ–Ω—å –ø–æ–ª–µ–∑–Ω—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∞ —Ç–∞–∫–∂–µ –∫—É—Ö–æ–Ω–Ω—ã–µ –≤–µ—Å—ã. –ù–µ –∑–∞–±—ã–≤–∞–π, —á—Ç–æ –∑–∞—á–∞—Å—Ç—É—é –∫–∞–ª–ª–æ—Ä–∏–π–Ω–æ—Å—Ç—å –ø—Ä–æ–¥—É–∫—Ç–∞ —É–∫–∞–∑–∞–Ω–∞ –Ω–∞ —Å—É—Ö–æ–π (–Ω–µ –≥–æ—Ç–æ–≤—ã–π) –ø—Ä–æ–¥—É–∫—Ç. –ü–æ—ç—Ç–æ–º—É –≤–∑–≤–µ—à–∏–≤–∞—Ç—å –≤—Å–µ –ø—Ä–æ—â–µ –¥–æ –≥–æ—Ç–æ–≤–∫–∏. –£–≥–ª–µ–≤–æ–¥—ã –ø–æ—Å—Ç–∞—Ä–∞–π—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–µ, –∞ –∂–∏—Ä—ã - –ø–æ–ª–µ–∑–Ω—ã–µ. 
                \n–ü–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ —Ü–µ–ª–µ–≤–æ–≥–æ –≤–µ—Å–∞, –º–æ–∂–µ—à—å –æ–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏ —è –ø—Ä–æ–∏–∑–≤–µ–¥—É –ø–µ—Ä–µ—Ä–∞—Å—á–µ—Ç –ø–æ–¥ –Ω–æ–≤—É—é —Ü–µ–ª—å. 
                \n–£–¥–∞—á–∏! –í—Å–µ –ø–æ–ª—É—á–∏—Ç—Å—è ‚ò∫Ô∏è
                ''')
                cursor.close()
                send_keyboard(msg)
            elif sex == '–ñ':
                target_calories = round(1.2 * (9.247 * last_weight + 447.593 + 3.098 * height * 100 - 4.33 * age))
                water_quantity = round(((target_calories / 1000) * 1), 2)
                fat_nutrient = round((0.35 * target_calories) / 9)
                protein_nutrient = round((0.25 * target_calories) / 4)
                carbs_nutrient = round((0.4 * target_calories) / 4)
                bot.send_message(msg.chat.id, f'''
                –¢–∞–∫—Å ü§î, —Å—É–¥—è –ø–æ –∏–º–µ—é—â–∏–º—Å—è —É –º–µ–Ω—è –¥–∞–Ω–Ω—ã–º —Ç–≤–æ–π —Ç–µ–∫—É—â–∏–π –∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–ø–∏—Å–∞–Ω–Ω—ã–π –≤–µ—Å —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç {last_weight} –∫–≥. –†–æ—Å—Ç = {height} –º; –í–æ–∑—Ä–∞—Å—Ç = {age}; –ü–æ–ª: {sex}.
                \n–ï—Å–ª–∏ —ç—Ç–æ –Ω–µ —Ç–∞–∫ - —Ç–µ–±–µ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –∫–æ–º–∞–Ω–¥–∞—Ö, –∏–Ω–∞—á–µ —Ä–∞—Å—á–µ—Ç –±—É–¥–µ—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º üòî.
                \n–î–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–∏ —Ç–µ–±–µ —Å–ª–µ–¥—É–µ—Ç –ø—Ä–∏–¥–µ—Ä–∂–∏–≤–∞—Ç—å—Å—è —Å–ª–µ–¥—É—é—â–∏—Ö –µ–∂–µ—Å—É—Ç–æ—á–Ω—ã—Ö –ø—Ä–æ–ø–æ—Ä—Ü–∏–π –≤ –ø–∏—Ç–∞–Ω–∏–∏:
                \n- {fat_nutrient} –≥ –∂–∏—Ä–æ–≤;
                \n- {protein_nutrient} –≥ –±–µ–ª–∫–æ–≤;
                \n- {carbs_nutrient} –≥ —É–≥–ª–µ–≤–æ–¥–æ–≤.
                \n- –ê —Ç–∞–∫–∂–µ –≤—ã–ø–∏–≤–∞—Ç—å –Ω–µ –º–µ–Ω—å—à–µ, —á–µ–º {water_quantity} –ª —á–∏—Å—Ç–æ–π –≤–æ–¥—ã!
                \n–ò—Ç–æ–≥–æ —Ç–≤–æ–π —Å—É–º–º–∞—Ä–Ω—ã–π —Ä–∞—Ü–∏–æ–Ω –∑–∞ –¥–µ–Ω—å —Å–æ—Å—Ç–∞–≤–∏—Ç {target_calories} –∫–∫–∞–ª.
                \n–î–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ –∏ –∑–∞–ø–∏—Å–∏ –±—É–¥—É—Ç –æ—á–µ–Ω—å –ø–æ–ª–µ–∑–Ω—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∞ —Ç–∞–∫–∂–µ –∫—É—Ö–æ–Ω–Ω—ã–µ –≤–µ—Å—ã. –ù–µ –∑–∞–±—ã–≤–∞–π, —á—Ç–æ –∑–∞—á–∞—Å—Ç—É—é –∫–∞–ª–ª–æ—Ä–∏–π–Ω–æ—Å—Ç—å –ø—Ä–æ–¥—É–∫—Ç–∞ —É–∫–∞–∑–∞–Ω–∞ –Ω–∞ —Å—É—Ö–æ–π (–Ω–µ –≥–æ—Ç–æ–≤—ã–π) –ø—Ä–æ–¥—É–∫—Ç. –ü–æ—ç—Ç–æ–º—É –≤–∑–≤–µ—à–∏–≤–∞—Ç—å –≤—Å–µ –ø—Ä–æ—â–µ –¥–æ –≥–æ—Ç–æ–≤–∫–∏. –£–≥–ª–µ–≤–æ–¥—ã –ø–æ—Å—Ç–∞—Ä–∞–π—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–µ, –∞ –∂–∏—Ä—ã - –ø–æ–ª–µ–∑–Ω—ã–µ. 
                \n–ü–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ —Ü–µ–ª–µ–≤–æ–≥–æ –≤–µ—Å–∞, –º–æ–∂–µ—à—å –æ–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏ —è –ø—Ä–æ–∏–∑–≤–µ–¥—É –ø–µ—Ä–µ—Ä–∞—Å—á–µ—Ç –ø–æ–¥ –Ω–æ–≤—É—é —Ü–µ–ª—å. 
                \n–£–¥–∞—á–∏! –í—Å–µ –ø–æ–ª—É—á–∏—Ç—Å—è ‚ò∫Ô∏è
                ''')
                cursor.close()
                send_keyboard(msg)
    elif call.text == "–í—ã—Å–æ–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å üèãÔ∏è‚Äç‚ôÇÔ∏è üî• üèãÔ∏è‚Äç‚ôÇ":
        with sqlite3.connect('fit_o_bot.db') as con:
            con.isolation_level = None
            cursor = con.cursor()
            cursor.execute(f'SELECT weight FROM bot_users_weights_table WHERE user_id=={msg.from_user.id} ORDER BY ID DESC LIMIT 1')
            last_weight = float(pretiffy(cursor.fetchall()))
            cursor.execute(f'SELECT sex FROM bot_users_list WHERE user_id=={msg.from_user.id} ORDER BY ID DESC LIMIT 1')
            sex = pretiffy(cursor.fetchall())
            cursor.execute(f'SELECT age FROM bot_users_list WHERE user_id=={msg.from_user.id} ORDER BY ID DESC LIMIT 1')
            age = int(pretiffy(cursor.fetchall()))
            cursor.execute(f'SELECT height FROM bot_users_list WHERE user_id=={msg.from_user.id} ORDER BY ID DESC LIMIT 1')
            height = float(pretiffy(cursor.fetchall()))
            if sex == '–ú':
                target_calories = round(1.4 * (13.397 * last_weight + 88.362 + 4.799 * height * 100 - 5.677 * age))
                water_quantity = round(((target_calories/ 1000) * 1),2)
                fat_nutrient = round((0.3 * target_calories) / 9)
                protein_nutrient = round((0.3 * target_calories) / 4)
                carbs_nutrient = round((0.4 * target_calories) / 4)
                bot.send_message(msg.chat.id, f'''
                –¢–∞–∫—Å ü§î, —Å—É–¥—è –ø–æ –∏–º–µ—é—â–∏–º—Å—è —É –º–µ–Ω—è –¥–∞–Ω–Ω—ã–º —Ç–≤–æ–π —Ç–µ–∫—É—â–∏–π –∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–ø–∏—Å–∞–Ω–Ω—ã–π –≤–µ—Å —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç {last_weight} –∫–≥. –†–æ—Å—Ç = {height} –º; –í–æ–∑—Ä–∞—Å—Ç = {age}; –ü–æ–ª: {sex}.
                \n–ï—Å–ª–∏ —ç—Ç–æ –Ω–µ —Ç–∞–∫ - —Ç–µ–±–µ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –∫–æ–º–∞–Ω–¥–∞—Ö, –∏–Ω–∞—á–µ —Ä–∞—Å—á–µ—Ç –±—É–¥–µ—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º üòî.
                \n–î–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–∏ —Ç–µ–±–µ —Å–ª–µ–¥—É–µ—Ç –ø—Ä–∏–¥–µ—Ä–∂–∏–≤–∞—Ç—å—Å—è —Å–ª–µ–¥—É—é—â–∏—Ö –µ–∂–µ—Å—É—Ç–æ—á–Ω—ã—Ö –ø—Ä–æ–ø–æ—Ä—Ü–∏–π –≤ –ø–∏—Ç–∞–Ω–∏–∏:
                \n- {fat_nutrient} –≥ –∂–∏—Ä–æ–≤;
                \n- {protein_nutrient} –≥ –±–µ–ª–∫–æ–≤;
                \n- {carbs_nutrient} –≥ —É–≥–ª–µ–≤–æ–¥–æ–≤.
                \n- –ê —Ç–∞–∫–∂–µ –≤—ã–ø–∏–≤–∞—Ç—å –Ω–µ –º–µ–Ω—å—à–µ, —á–µ–º {water_quantity} –ª —á–∏—Å—Ç–æ–π –≤–æ–¥—ã!
                \n–ò—Ç–æ–≥–æ —Ç–≤–æ–π —Å—É–º–º–∞—Ä–Ω—ã–π —Ä–∞—Ü–∏–æ–Ω –∑–∞ –¥–µ–Ω—å —Å–æ—Å—Ç–∞–≤–∏—Ç {target_calories} –∫–∫–∞–ª.
                \n–î–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ –∏ –∑–∞–ø–∏—Å–∏ –±—É–¥—É—Ç –æ—á–µ–Ω—å –ø–æ–ª–µ–∑–Ω—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∞ —Ç–∞–∫–∂–µ –∫—É—Ö–æ–Ω–Ω—ã–µ –≤–µ—Å—ã. –ù–µ –∑–∞–±—ã–≤–∞–π, —á—Ç–æ –∑–∞—á–∞—Å—Ç—É—é –∫–∞–ª–ª–æ—Ä–∏–π–Ω–æ—Å—Ç—å –ø—Ä–æ–¥—É–∫—Ç–∞ —É–∫–∞–∑–∞–Ω–∞ –Ω–∞ —Å—É—Ö–æ–π (–Ω–µ –≥–æ—Ç–æ–≤—ã–π) –ø—Ä–æ–¥—É–∫—Ç. –ü–æ—ç—Ç–æ–º—É –≤–∑–≤–µ—à–∏–≤–∞—Ç—å –≤—Å–µ –ø—Ä–æ—â–µ –¥–æ –≥–æ—Ç–æ–≤–∫–∏. –£–≥–ª–µ–≤–æ–¥—ã –ø–æ—Å—Ç–∞—Ä–∞–π—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–µ, –∞ –∂–∏—Ä—ã - –ø–æ–ª–µ–∑–Ω—ã–µ. 
                \n–ü–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ —Ü–µ–ª–µ–≤–æ–≥–æ –≤–µ—Å–∞, –º–æ–∂–µ—à—å –æ–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏ —è –ø—Ä–æ–∏–∑–≤–µ–¥—É –ø–µ—Ä–µ—Ä–∞—Å—á–µ—Ç –ø–æ–¥ –Ω–æ–≤—É—é —Ü–µ–ª—å. 
                \n–£–¥–∞—á–∏! –í—Å–µ –ø–æ–ª—É—á–∏—Ç—Å—è ‚ò∫Ô∏è
                ''')
                cursor.close()
                send_keyboard(msg)
            elif sex == '–ñ':
                target_calories = round(1.4 * (9.247 * last_weight + 447.593 + 3.098 * height * 100 - 4.33 * age))
                water_quantity = round(((target_calories / 1000) * 1), 2)
                fat_nutrient = round((0.3 * target_calories) / 9)
                protein_nutrient = round((0.3 * target_calories) / 4)
                carbs_nutrient = round((0.4 * target_calories) / 4)
                bot.send_message(msg.chat.id, f'''
                –¢–∞–∫—Å ü§î, —Å—É–¥—è –ø–æ –∏–º–µ—é—â–∏–º—Å—è —É –º–µ–Ω—è –¥–∞–Ω–Ω—ã–º —Ç–≤–æ–π —Ç–µ–∫—É—â–∏–π –∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–ø–∏—Å–∞–Ω–Ω—ã–π –≤–µ—Å —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç {last_weight} –∫–≥. –†–æ—Å—Ç = {height} –º; –í–æ–∑—Ä–∞—Å—Ç = {age}; –ü–æ–ª: {sex}.
                \n–ï—Å–ª–∏ —ç—Ç–æ –Ω–µ —Ç–∞–∫ - —Ç–µ–±–µ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –∫–æ–º–∞–Ω–¥–∞—Ö, –∏–Ω–∞—á–µ —Ä–∞—Å—á–µ—Ç –±—É–¥–µ—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º üòî.
                \n–î–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–∏ —Ç–µ–±–µ —Å–ª–µ–¥—É–µ—Ç –ø—Ä–∏–¥–µ—Ä–∂–∏–≤–∞—Ç—å—Å—è —Å–ª–µ–¥—É—é—â–∏—Ö –µ–∂–µ—Å—É—Ç–æ—á–Ω—ã—Ö –ø—Ä–æ–ø–æ—Ä—Ü–∏–π –≤ –ø–∏—Ç–∞–Ω–∏–∏:
                \n- {fat_nutrient} –≥ –∂–∏—Ä–æ–≤;
                \n- {protein_nutrient} –≥ –±–µ–ª–∫–æ–≤;
                \n- {carbs_nutrient} –≥ —É–≥–ª–µ–≤–æ–¥–æ–≤.
                \n- –ê —Ç–∞–∫–∂–µ –≤—ã–ø–∏–≤–∞—Ç—å –Ω–µ –º–µ–Ω—å—à–µ, —á–µ–º {water_quantity} –ª —á–∏—Å—Ç–æ–π –≤–æ–¥—ã!
                \n–ò—Ç–æ–≥–æ —Ç–≤–æ–π —Å—É–º–º–∞—Ä–Ω—ã–π —Ä–∞—Ü–∏–æ–Ω –∑–∞ –¥–µ–Ω—å —Å–æ—Å—Ç–∞–≤–∏—Ç {target_calories} –∫–∫–∞–ª.
                \n–î–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ –∏ –∑–∞–ø–∏—Å–∏ –±—É–¥—É—Ç –æ—á–µ–Ω—å –ø–æ–ª–µ–∑–Ω—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∞ —Ç–∞–∫–∂–µ –∫—É—Ö–æ–Ω–Ω—ã–µ –≤–µ—Å—ã. –ù–µ –∑–∞–±—ã–≤–∞–π, —á—Ç–æ –∑–∞—á–∞—Å—Ç—É—é –∫–∞–ª–ª–æ—Ä–∏–π–Ω–æ—Å—Ç—å –ø—Ä–æ–¥—É–∫—Ç–∞ —É–∫–∞–∑–∞–Ω–∞ –Ω–∞ —Å—É—Ö–æ–π (–Ω–µ –≥–æ—Ç–æ–≤—ã–π) –ø—Ä–æ–¥—É–∫—Ç. –ü–æ—ç—Ç–æ–º—É –≤–∑–≤–µ—à–∏–≤–∞—Ç—å –≤—Å–µ –ø—Ä–æ—â–µ –¥–æ –≥–æ—Ç–æ–≤–∫–∏. –£–≥–ª–µ–≤–æ–¥—ã –ø–æ—Å—Ç–∞—Ä–∞–π—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–µ, –∞ –∂–∏—Ä—ã - –ø–æ–ª–µ–∑–Ω—ã–µ. 
                \n–ü–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ —Ü–µ–ª–µ–≤–æ–≥–æ –≤–µ—Å–∞, –º–æ–∂–µ—à—å –æ–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏ —è –ø—Ä–æ–∏–∑–≤–µ–¥—É –ø–µ—Ä–µ—Ä–∞—Å—á–µ—Ç –ø–æ–¥ –Ω–æ–≤—É—é —Ü–µ–ª—å. 
                \n–£–¥–∞—á–∏! –í—Å–µ –ø–æ–ª—É—á–∏—Ç—Å—è ‚ò∫Ô∏è
                ''')
                cursor.close()
                send_keyboard(msg)
def delete_last(msg):
    with sqlite3.connect('fit_o_bot.db') as con:
        con.isolation_level = None
        cursor = con.cursor()
        cursor.execute(f'DELETE FROM bot_users_weights_table WHERE user_id=={msg.from_user.id} ORDER BY ID DESC LIMIT 1')
        cursor.close()
        bot.send_message(msg.chat.id, '–ü—Ä–æ—à–ª–æ —É—Å–ø–µ—à–Ω–æ!')
        send_keyboard(msg, "–ß–µ–º –µ—â–µ –º–æ–≥—É –ø–æ–º–æ—á—å?")
def delete_all(msg):
    with sqlite3.connect('fit_o_bot.db') as con:
        con.isolation_level = None
        cursor = con.cursor()
        cursor.execute(f'DELETE FROM bot_users_weights_table WHERE user_id=={msg.from_user.id}')
        cursor.close()
        bot.send_message(msg.chat.id, '–ò –Ω–∞—á–Ω–µ–º –≤—Å–µ —Å —á–∏—Å—Ç–æ–≥–æ –ª–∏—Å—Ç–∞! ü•Ç')
        send_keyboard(msg, "–ß–µ–º –µ—â–µ –º–æ–≥—É –ø–æ–º–æ—á—å?")
def activity_keyboard(msg, text = '''
–í —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å–æ —Å–≤–æ–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é –Ω–∞–∂–º–∏ –Ω–∞ –Ω—É–∂—É—é –∫–Ω–æ–ø–∫—É üòâ. 
\n- –ù–∏–∑–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å üêå (–Ω–µ —Ç—Ä–µ–Ω–∏—Ä—É–µ—à—å—Å—è, –Ω–æ –∏–Ω–æ–≥–¥–∞ –ø–æ–ª—É—á–∞–µ—Ç—Å—è –≥—É–ª—è—Ç—å)
\n- –°—Ä–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å üèÑ‚Äç‚ôÄÔ∏èüèÑ‚Äç‚ôÇÔ∏è (1-2 —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –≤ –Ω–µ–¥–µ–ª—é, –µ–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Ö–æ–¥—å–±–∞ –ø–æ 1,5-2 —á–∞—Å–∞ –≤ –¥–µ–Ω—å)
\n- –í—ã—Å–æ–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å üèãÔ∏è‚Äç‚ôÇÔ∏è üî• üèãÔ∏è‚Äç‚ôÄÔ∏è(> 3 —Å–∏–ª–æ–≤—ã—Ö/–∫–∞—Ä–¥–∏–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –≤ –Ω–µ–¥–µ–ª—é, –µ–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Ö–æ–¥—å–±–∞ –±–æ–ª–µ–µ 2 —á–∞—Å–æ–≤)
'''):
    keyboard = types.ReplyKeyboardMarkup(row_width=1)
    itembtn0 = types.KeyboardButton('–ù–∏–∑–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å üêå')
    itembtn1 = types.KeyboardButton('–°—Ä–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å üèÑ‚Äç‚ôÄÔ∏èüèÑ‚Äç‚ôÇÔ∏è')
    itembtn2 = types.KeyboardButton('–í—ã—Å–æ–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å üèãÔ∏è‚Äç‚ôÇÔ∏è üî• üèãÔ∏è‚Äç‚ôÄ')
    keyboard.add(itembtn0, itembtn1, itembtn2)
    msg = bot.send_message(message.from_user.id, text=text, reply_markup=keyboard)
    if call.text == "–•–æ—á—É –ø–æ–¥–Ω–∞–±—Ä–∞—Ç—å –º–∞—Å—Å—ã üí™":
        bot.register_next_step_handler(msg, increase_weight)
    elif call.text == "–•–æ—á—É —Å–æ–≥–Ω–∞—Ç—å –∂–∏—Ä–æ–∫ ü•¶":
        bot.register_next_step_handler(msg, decrease_weight)
def callback_worker(call):
    if call.text == "–•–æ—á—É —Å–æ–æ–±—â–∏—Ç—å —Å–≤–æ–π —Ç–µ–∫—É—â–∏–π –≤–µ—Å üò±":
        msg = bot.send_message(call.chat.id, f'''
        \n–ù–µ –±–æ–π—Å—è, –æ—Ç–ø—Ä–∞–≤–ª—è–π —Å–≤–æ–π —Ç–µ–∫—É—â–∏–π –≤–µ—Å, –Ω–∞ —Å–≤–æ–µ–º –≤–µ–∫—É —è –≤–∏–¥–∞–ª –º–Ω–æ–≥–æ–µ..
        \n–ü—Ä–∏—Å—ã–ª–∞–π –≤ —Ñ–æ—Ä–º–∞—Ç–µ —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã –∏ –≤–µ—Å–∞ —Ä–∞–∑–¥–µ–ª–µ–Ω–Ω—ã—Ö –ø—Ä–æ–±–µ–ª–æ–º, –º–Ω–µ –Ω—É–∂–Ω–æ –∑–∞–ø–∏—Å–∞—Ç—å —ç—Ç–æ –≤ —Å–≤–æ–π –∂—É—Ä–Ω–∞–ª:)
        \n–ù—É–∂–µ–Ω —Å–ª–µ–¥—É—é—â–∏–π —Ñ–æ—Ä–º–∞—Ç: dd-mm-yyyy 85.4 (–≥–¥–µ –ø–µ—Ä–≤–∞—è —á–∞—Å—Ç—å - –¥–∞—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: 16-04-1996, –∞ –≤—Ç–æ—Ä–∞—è - –≤–µ—Å).''')
        bot.register_next_step_handler(msg, add_weight)

    elif call.text == "–•–æ—á—É –ø–æ–¥–Ω–∞–±—Ä–∞—Ç—å –º–∞—Å—Å—ã üí™":
        try:
            # increase_weight(call)
            activity_keyboard(call, text = "–•–æ—á—É –ø–æ–¥–Ω–∞–±—Ä–∞—Ç—å –º–∞—Å—Å—ã üí™")
        except:
            bot.send_message(call.chat.id, '–ö–∞–∂–µ—Ç—Å—è, –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ —Ç–≤–æ–µ–º –≤–µ—Å–µ, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–Ω–∞—á–∞–ª–∞ –∏—Ö –≤–≤–µ—Å—Ç–∏ üòõ')
            send_keyboard(call, "–ß–µ–º –µ—â–µ –º–æ–≥—É –ø–æ–º–æ—á—å?")

    elif call.text == "–•–æ—á—É —Å–æ–≥–Ω–∞—Ç—å –∂–∏—Ä–æ–∫ ü•¶":
        try:
            # decrease_weight(call)
            activity_keyboard(call, text = "–•–æ—á—É —Å–æ–≥–Ω–∞—Ç—å –∂–∏—Ä–æ–∫ ü•¶")
        except:
            bot.send_message(call.chat.id, '–ö–∞–∂–µ—Ç—Å—è, –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ —Ç–≤–æ–µ–º –≤–µ—Å–µ, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–Ω–∞—á–∞–ª–∞ –∏—Ö –≤–≤–µ—Å—Ç–∏ üòõ')
            send_keyboard(call, "–ß–µ–º –µ—â–µ –º–æ–≥—É –ø–æ–º–æ—á—å?")

    elif call.text == "–•–æ—á—É –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Å–≤–æ–µ–≥–æ –≤–µ—Å–∞ üòà":
        try:
            weight_statistic(call)
        except:
            bot.send_message(call.chat.id, '–ö–∞–∂–µ—Ç—Å—è, –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ —Ç–≤–æ–µ–º –≤–µ—Å–µ, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–Ω–∞—á–∞–ª–∞ –∏—Ö –≤–≤–µ—Å—Ç–∏ üòõ')
            send_keyboard(call, "–ß–µ–º –µ—â–µ –º–æ–≥—É –ø–æ–º–æ—á—å?")
    elif call.text == "–£–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é –∑–∞–ø–∏—Å—å –≤–µ—Å–∞":
        try:
            delete_last(call)
        except:
            bot.send_message(call.chat.id, '–ö–∞–∂–µ—Ç—Å—è, –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ —Ç–≤–æ–µ–º –≤–µ—Å–µ, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–Ω–∞—á–∞–ª–∞ –∏—Ö –≤–≤–µ—Å—Ç–∏ üòõ')
            send_keyboard(call, "–ß–µ–º –µ—â–µ –º–æ–≥—É –ø–æ–º–æ—á—å?")
    elif call.text == "–£–¥–∞–ª–∏—Ç—å –≤—Å–µ –∑–∞–ø–∏—Å–∏":
        try:
            delete_all(call)
        except:
            bot.send_message(call.chat.id, '–ö–∞–∂–µ—Ç—Å—è, –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ —Ç–≤–æ–µ–º –≤–µ—Å–µ, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–Ω–∞—á–∞–ª–∞ –∏—Ö –≤–≤–µ—Å—Ç–∏ üòõ')
            send_keyboard(call, "–ß–µ–º –µ—â–µ –º–æ–≥—É –ø–æ–º–æ—á—å?")
@bot.message_handler(content_types=['text'])
def handle_docs_audio(message):
    send_keyboard(message, text="–Ø –Ω–µ –ø–æ–Ω–∏–º–∞—é :-( –í—ã–±–µ—Ä–∏ –æ–¥–∏–Ω –∏–∑ –ø—É–Ω–∫—Ç–æ–≤ –º–µ–Ω—é:")
@bot.message_handler(commands=["stop"])
def stop(message):
    with sqlite3.connect('fit_o_bot.db') as con:
        con.isolation_level = None
        cursor = con.cursor()
        cursor.execute(f'DELETE FROM bot_users_weights_table WHERE user_id=={msg.from_user.id}')
        cursor.execute(f'DELETE FROM bot_users_list WHERE user_id=={msg.from_user.id}')
        bot.send_message(call.chat.id, "–ü–æ–∫–∞-–ø–æ–∫–∞:)üëã –î–æ –Ω–æ–≤—ã—Ö –≤—Å—Ç—Ä–µ—á!)")
        cursor.close()
bot.infinity_polling()