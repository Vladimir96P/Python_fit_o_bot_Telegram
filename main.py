import telebot
from telebot import types
import statistics
import sqlite3
bot = telebot.TeleBot("5058162485:AAHGx9-XieFGAaHLb3cVumTcokI1RkwGJbg")
user_dict = {}
class User:
    def __init__(self, name):
        self.name = name
@bot.message_handler(commands=['start', 'help'])
def send_welcome(message):
    msg = bot.reply_to(message, "–•—ç–π! –ú–µ–Ω—è –∑–æ–≤—É—Ç –§–∏—Ç–æ–±–æ—Çüòä –ê —Ç–µ–±—è –∫–∞–∫?")
    bot.register_next_step_handler(msg, user_name)
def send_keyboard(message, text = "–í—ã–±–µ—Ä–∏ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–π —Ä–∞–∑–¥–µ–ª üòâ"):
    keyboard = types.ReplyKeyboardMarkup(row_width=2)
    itembtn0 = types.KeyboardButton('–•–æ—á—É —Å–æ–æ–±—â–∏—Ç—å —Å–≤–æ–π —Ç–µ–∫—É—â–∏–π –≤–µ—Å üò±')
    itembtn1 = types.KeyboardButton('–•–æ—á—É –ø–æ–¥–Ω–∞–±—Ä–∞—Ç—å –º–∞—Å—Å—ã üí™')
    itembtn2 = types.KeyboardButton('–•–æ—á—É —Å–æ–≥–Ω–∞—Ç—å –∂–∏—Ä–æ–∫ ü•¶')
    itembtn3 = types.KeyboardButton('–•–æ—á—É –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Å–≤–æ–µ–≥–æ –≤–µ—Å–∞ üòà')
    itembtn4 = types.KeyboardButton('–£–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é –∑–∞–ø–∏—Å—å –≤–µ—Å–∞')
    itembtn5 = types.KeyboardButton("–£–¥–∞–ª–∏—Ç—å –≤—Å–µ –∑–∞–ø–∏—Å–∏")
    keyboard.add(itembtn0, itembtn1, itembtn2, itembtn3, itembtn4, itembtn5)
    msg = bot.send_message(message.from_user.id,
                     text=text, reply_markup=keyboard)
    bot.register_next_step_handler(msg, callback_worker)
def user_name(message):
    try:
        chat_id = message.chat.id
        name = message.text.title()
        user = User(name)
        user_dict[chat_id] = user
        msg = bot.send_message(message.from_user.id, f'''–ü—Ä–∏–≤–µ—Ç! –ü—Ä–∏—è—Ç–Ω–æ –ø–æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è, {name} üòú. –í—ã–±–∏—Ä–∞–π –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â—É—é —Ç–µ–±—è —Ç–µ–º—É:) –ò –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –Ω–µ –∑–∞–±—É–¥—å –≤–≤–µ—Å—Ç–∏ —Å–≤–æ–π —Ç–µ–∫—É—â–∏–π –≤–µ—Å!)''')
        send_keyboard(message)
        bot.register_next_step_handler(msg, callback_worker)
    except Exception as e:
        bot.reply_to(message, '–°–æ—Ä—Ä–∏, –º–µ–Ω—è –æ—Ç–≤–ª–µ–∫–ª–∏, –¥–∞–≤–∞–π –ø–æ–ø—Ä–æ–±—É–µ–º –µ—â–µ —Ä–∞–∑ üôè')
conn = sqlite3.connect('fit_o_bot.db')
cursor = conn.cursor()
try:
    query = "CREATE TABLE \"users_weights_table\" (\"ID\" INTEGER UNIQUE, \"user_id\" INTEGER,\"date\" DATE,\"weight\" FLOAT, PRIMARY KEY (\"ID\"))"
    cursor.execute(query)
except:
    pass
def add_weight(msg):
    current_date = msg.text.split()[0]
    current_weight = msg.text.split()[1]
    try:
        float(current_weight)
        with sqlite3.connect('fit_o_bot.db') as con:
            cursor = con.cursor()
            cursor.execute('INSERT INTO users_weights_table (user_id, date, weight) VALUES (?, ?, ?)',
                           (msg.from_user.id, current_date, current_weight))
            con.commit()
        bot.send_message(msg.chat.id, '–ö–∞–∫ –∫–æ–≥–¥–∞-—Ç–æ —Å–∫–∞–∑–∞–ª –ê—Ä–∏—Å—Ç–æ—Ç–µ–ª—å: \"–ü–æ–∑–Ω–∞–Ω–∏–µ –≤—Å–µ–≥–¥–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å —É–¥–∏–≤–ª–µ–Ω–∏—è\"..')
        send_keyboard(msg)
    except:
        bot.send_message(msg.chat.id, '–í–≤–µ–¥–µ–Ω –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç :(')
        send_keyboard(msg)
def get_nice(data_list):
    data_str = []
    for val in list(data_list):
        data_str.append(f'{val[0]} = {val[1]} –∫–≥\n')
    return ''.join(data_str)
def weight_statistic(msg):
    with sqlite3.connect('fit_o_bot.db') as con:
        cursor = con.cursor()
        cursor.execute(f'SELECT date, weight FROM users_weights_table WHERE user_id=={msg.from_user.id}')
        c = cursor.fetchall()
        data_list = get_nice(c)
        bot.send_message(msg.chat.id, data_list)
        send_keyboard(msg, "–û—Ö! –°–Ω–∞—á–∞–ª–∞ –ø–æ–¥—É–º–∞–ª, —á—Ç–æ —ç—Ç–æ –ø—Ä–∏–º–µ—Ä –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–∏, –∞ –æ–∫–∞–∑–∞–ª–æ—Å—å..")
def pretiffy_weight(last_weight):
    for val in last_weight:
        last_w = val[0]
        return last_w
def increase_weight(msg):
    with sqlite3.connect('fit_o_bot.db') as con:
        cursor = con.cursor()
        cursor.execute(f'SELECT weight FROM users_weights_table WHERE user_id=={msg.from_user.id} ORDER BY ID DESC LIMIT 1')
        last_weight = pretiffy_weight(cursor.fetchall())
        target_weight = round((last_weight + 4), 2)
        fats_nutrient = round(target_weight * 1)
        protein_nutrient = round(target_weight * 2.2)
        carbs_nutrient = round(target_weight * 3.5)
        total_calories = round(fats_nutrient * 9) + (protein_nutrient * 4) + (carbs_nutrient * 4)
        bot.send_message(msg.chat.id, f'''
        –¢–∞–∫—Å ü§î, —Å—É–¥—è –ø–æ –∏–º–µ—é—â–∏–º—Å—è —É –º–µ–Ω—è –¥–∞–Ω–Ω—ã–º —Ç–≤–æ–π —Ç–µ–∫—É—â–∏–π –∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–ø–∏—Å–∞–Ω–Ω—ã–π –≤–µ—Å —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç {last_weight} –∫–≥. 
        \n–ï—Å–ª–∏ —ç—Ç–æ –Ω–µ —Ç–∞–∫ - —Ç–µ–±–µ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, —Å–æ–æ–±—â–∏–≤ —Å–≤–æ–π —Ç–µ–∫—É—â–∏–π –≤–µ—Å –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –∫–æ–º–∞–Ω–¥–µ.
        \n–í —Ü–µ–ª—è—Ö –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞ —Å—Ç–∞–≤–∏–º –ø–ª–∞–Ω–∫—É —Ü–µ–ª–µ–≤–æ–≥–æ –≤–µ—Å–∞ –≤ {target_weight} –∫–≥. –î–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–∏ —Ç–µ–±–µ —Å–ª–µ–¥—É–µ—Ç –ø—Ä–∏–¥–µ—Ä–∂–∏–≤–∞—Ç—å—Å—è —Å–ª–µ–¥—É—é—â–∏—Ö –µ–∂–µ—Å—É—Ç–æ—á–Ω—ã—Ö –ø—Ä–æ–ø–æ—Ä—Ü–∏–π –≤ –ø–∏—Ç–∞–Ω–∏–∏:
        \n- {fats_nutrient} –≥ –∂–∏—Ä–æ–≤;
        \n- {protein_nutrient} –≥ –±–µ–ª–∫–æ–≤;
        \n- {carbs_nutrient} –≥ —É–≥–ª–µ–≤–æ–¥–æ–≤.
        \n–ò—Ç–æ–≥–æ —Ç–≤–æ–π —Å—É–º–º–∞—Ä–Ω—ã–π —Ä–∞—Ü–∏–æ–Ω –∑–∞ –¥–µ–Ω—å —Å–æ—Å—Ç–∞–≤–∏—Ç {total_calories} –∫–∫–∞–ª.
        \n–î–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ –∏ –∑–∞–ø–∏—Å–∏ –±—É–¥—É—Ç –æ—á–µ–Ω—å –ø–æ–ª–µ–∑–Ω—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∞ —Ç–∞–∫–∂–µ –∫—É—Ö–æ–Ω–Ω—ã–µ –≤–µ—Å—ã. –ù–µ –∑–∞–±—ã–≤–∞–π, —á—Ç–æ –∑–∞—á–∞—Å—Ç—É—é –∫–∞–ª–ª–æ—Ä–∏–π–Ω–æ—Å—Ç—å –ø—Ä–æ–¥—É–∫—Ç–∞ —É–∫–∞–∑–∞–Ω–∞ –Ω–∞ —Å—É—Ö–æ–π (–Ω–µ –≥–æ—Ç–æ–≤—ã–π) –ø—Ä–æ–¥—É–∫—Ç. –ü–æ—ç—Ç–æ–º—É –≤–∑–≤–µ—à–∏–≤–∞—Ç—å –≤—Å–µ –ø—Ä–æ—â–µ –¥–æ –≥–æ—Ç–æ–≤–∫–∏. –ó–∞–º–æ—Ä–∞—á–∏–≤–∞—Ç—å—Å—è –¥–æ –∫–∞–∂–¥–æ–π –∫–∞–ª–ª–æ—Ä–∏–∏ –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É—é, —Ç–∞–∫ –∫–∞–∫ —Ä–∞–∑–±—Ä–æ—Å –æ—Ç –∑–∞—è–≤–ª–µ–Ω–Ω–æ–≥–æ –º–æ–∂–µ—Ç –¥–æ—Ö–æ–¥–∏—Ç—å –¥–æ +- 10%. –ú—ã —Å–∫–æ—Ä–µ–µ –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –≤–µ–∫—Ç–æ—Ä –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –Ω—É—Ç—Ä–∏–µ–Ω—Ç–æ–≤. –£–≥–ª–µ–≤–æ–¥—ã –ø–æ—Å—Ç–∞—Ä–∞–π—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–µ, –∞ –∂–∏—Ä—ã –ø–æ–ª–µ–∑–Ω—ã–µ (–µ—Å–ª–∏ –Ω–µ –∑–Ω–∞–∫–æ–º–æ - –≥—É–≥–ª –ø–æ–¥—Å–∫–∞–∂–µ—Ç). 
        \n–ù—É –∏ –Ω–µ –∑–∞–±—ã–≤–∞–π –æ–± –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏, –µ–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Ö–æ–¥—å–±–∞ –∏ –∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ —Ç—Ä–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –≤ –Ω–µ–¥–µ–ª—é, –∞ —Ç–∞–∫–∂–µ –æ —Å–æ–±–ª—é–¥–µ–Ω–∏–∏ –ø–∏—Ç—å–µ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞ (–∏–º–µ–Ω–Ω–æ —á–∏—Å—Ç–æ–π –≤–æ–¥—ã).
        \n–ü–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ —Ü–µ–ª–µ–≤–æ–≥–æ –≤–µ—Å–∞, –º–æ–∂–µ—à—å –æ–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏ —è –ø—Ä–æ–∏–∑–≤–µ–¥—É –ø–µ—Ä–µ—Ä–∞—Å—á–µ—Ç –ø–æ–¥ –Ω–æ–≤—É—é —Ü–µ–ª—å. 
        \n–£–¥–∞—á–∏! –í—Å–µ –ø–æ–ª—É—á–∏—Ç—Å—è ‚ò∫Ô∏è
''')
        send_keyboard(msg)
def decrease_weight(msg):
    with sqlite3.connect('fit_o_bot.db') as con:
        cursor = con.cursor()
        cursor.execute(f'SELECT weight FROM users_weights_table WHERE user_id=={msg.from_user.id} ORDER BY ID DESC LIMIT 1')
        last_weight = pretiffy_weight(cursor.fetchall())
        target_weight = round((last_weight - 4), 2)
        fats_nutrient = round(target_weight * 1.2)
        protein_nutrient = round(target_weight * 2.5)
        carbs_nutrient = round(target_weight * 1)
        total_calories = round((fats_nutrient * 9) + (protein_nutrient * 4) + (carbs_nutrient * 4))
        bot.send_message(msg.chat.id, f'''
        –•–æ—Ä–æ—à–æ üëç, —Å—É–¥—è –ø–æ –∏–º–µ—é—â–∏–º—Å—è —É –º–µ–Ω—è –¥–∞–Ω–Ω—ã–º —Ç–≤–æ–π —Ç–µ–∫—É—â–∏–π –∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–ø–∏—Å–∞–Ω–Ω—ã–π –≤–µ—Å —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç {last_weight} –∫–≥.
        \n–ï—Å–ª–∏ —ç—Ç–æ –Ω–µ —Ç–∞–∫ - —Ç–µ–±–µ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, —Å–æ–æ–±—â–∏–≤ —Å–≤–æ–π —Ç–µ–∫—É—â–∏–π –≤–µ—Å –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –∫–æ–º–∞–Ω–¥–µ.
        \n–í —Ü–µ–ª—è—Ö –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ–≥–æ —Å–Ω–∏–∂–µ–Ω–∏—è –≤–µ—Å–∞ –æ–±–æ–∑–Ω–∞—á–∏–º —Ü–µ–ª–µ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ {target_weight} –∫–≥. –î–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–∏ —Ç–µ–±–µ —Å–ª–µ–¥—É–µ—Ç –ø—Ä–∏–¥–µ—Ä–∂–∏–≤–∞—Ç—å—Å—è —Å–ª–µ–¥—É—é—â–∏—Ö –µ–∂–µ—Å—É—Ç–æ—á–Ω—ã—Ö –ø—Ä–æ–ø–æ—Ä—Ü–∏–π –≤ –ø–∏—Ç–∞–Ω–∏–∏:
        \n- {fats_nutrient} –≥ –∂–∏—Ä–æ–≤;
        \n- {protein_nutrient} –≥ –±–µ–ª–∫–æ–≤;
        \n- {carbs_nutrient} –≥ —É–≥–ª–µ–≤–æ–¥–æ–≤.
        \n–ò—Ç–æ–≥–æ —Ç–≤–æ–π —Å—É–º–º–∞—Ä–Ω—ã–π —Ä–∞—Ü–∏–æ–Ω –∑–∞ –¥–µ–Ω—å —Å–æ—Å—Ç–∞–≤–∏—Ç {total_calories} –∫–∫–∞–ª.
        \n–î–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ –∏ –∑–∞–ø–∏—Å–∏ –±—É–¥—É—Ç –æ—á–µ–Ω—å –ø–æ–ª–µ–∑–Ω—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∞ —Ç–∞–∫–∂–µ –∫—É—Ö–æ–Ω–Ω—ã–µ –≤–µ—Å—ã. –ù–µ –∑–∞–±—ã–≤–∞–π, —á—Ç–æ –∑–∞—á–∞—Å—Ç—É—é –∫–∞–ª–ª–æ—Ä–∏–π–Ω–æ—Å—Ç—å –ø—Ä–æ–¥—É–∫—Ç–∞ —É–∫–∞–∑–∞–Ω–∞ –Ω–∞ —Å—É—Ö–æ–π (–Ω–µ –≥–æ—Ç–æ–≤—ã–π) –ø—Ä–æ–¥—É–∫—Ç. –ü–æ—ç—Ç–æ–º—É –≤–∑–≤–µ—à–∏–≤–∞—Ç—å –≤—Å–µ –ø—Ä–æ—â–µ –¥–æ –≥–æ—Ç–æ–≤–∫–∏. –ó–∞–º–æ—Ä–∞—á–∏–≤–∞—Ç—å—Å—è –¥–æ –∫–∞–∂–¥–æ–π –∫–∞–ª–ª–æ—Ä–∏–∏ –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É—é, —Ç–∞–∫ –∫–∞–∫ —Ä–∞–∑–±—Ä–æ—Å –æ—Ç –∑–∞—è–≤–ª–µ–Ω–Ω–æ–≥–æ –º–æ–∂–µ—Ç –¥–æ—Ö–æ–¥–∏—Ç—å –¥–æ +- 10%. –ú—ã —Å–∫–æ—Ä–µ–µ –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –≤–µ–∫—Ç–æ—Ä –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –Ω—É—Ç—Ä–∏–µ–Ω—Ç–æ–≤. –£–≥–ª–µ–≤–æ–¥—ã –ø–æ—Å—Ç–∞—Ä–∞–π—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–µ, –∞ –∂–∏—Ä—ã –ø–æ–ª–µ–∑–Ω—ã–µ (–µ—Å–ª–∏ –Ω–µ –∑–Ω–∞–∫–æ–º–æ - –≥—É–≥–ª –ø–æ–¥—Å–∫–∞–∂–µ—Ç).
        \n–ü–æ—Å–∫–æ–ª—å–∫—É —Ç–≤–æ—è —Ü–µ–ª—å —Å–Ω–∏–∂–µ–Ω–∏–µ –≤–µ—Å–∞ - —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ —Ä–∞—Ü–∏–æ–Ω–µ –ø–æ–±–æ–ª—å—à–µ –∫–ª–µ—Ç—á–∞–∫–∏ –∏ –æ—Å–æ–±–µ–Ω–Ω–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–µ –∑–∞–±—ã–≤–∞—Ç—å –æ —Å–æ–±–ª—é–¥–µ–Ω–∏–∏ –ø–∏—Ç—å–µ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞. –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Ö–æ–¥—å–±–∞ –∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ —Ç—Ä–∏ —Ä–∞–∑–∞ –≤ –Ω–µ–¥–µ–ª—é - –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é—Ç—Å—è!
        \n–ü–æ–º–Ω–∏, —á—Ç–æ —Å–Ω–∏–∂–µ–Ω–∏–µ –∂–∏—Ä–∞ —è–≤–ª—è–µ—Ç—Å—è —Å—Ç—Ä–µ—Å—Å–æ–º –¥–ª—è –æ—Ä–≥–∞–Ω–∏–∑–º–∞, –ø–æ—ç—Ç–æ–º—É –ø–µ—Ä–µ–¥ –¥–∞–Ω–Ω—ã–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º –Ω—É–∂–Ω–æ –ø—Ä–æ–∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è —Å –≤—Ä–∞—á–æ–º –∏ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —É —Ç–µ–±—è –Ω–µ—Ç –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–∫–∞–∑–∞–Ω–∏–π –∫ —Ç–∞–∫–æ–º—É —Ç–∏–ø—É –ø–∏—Ç–∞–Ω–∏—è. 
        \n–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω–∞—è –º–Ω–æ–π –ø—Ä–æ–ø–æ—Ä—Ü–∏—è –Ω—É—Ç—Ä–∏–µ–Ω—Ç–æ–≤ –¥–æ–≤–æ–ª—å–Ω–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞ –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è –ø–æ–¥–∫–æ–∂–Ω–æ–≥–æ –∂–∏—Ä–∞, –Ω–æ –≤–≤–∏–¥—É –º–∞–ª–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —É–≥–ª–µ–≤–æ–¥–æ–≤ –Ω–∞–¥–æ –±—ã—Ç—å –≥–æ—Ç–æ–≤—ã–º –∫ –ø–ª–æ—Ö–æ–º—É –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—é –∏ –æ—â—É—â–µ–Ω–∏—é –ø–æ–Ω–∏–∂–µ–Ω–Ω–æ–π —ç–Ω–µ—Ä–≥–∏–∏, –æ—Å–æ–±–µ–Ω–Ω–æ –≤ –ø–µ—Ä–≤–æ–µ –≤—Ä–µ–º—è. –û–¥–Ω–∞–∫–æ, –æ–Ω–∞ –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è —Ö–æ—Ä–æ—à–µ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –∂–∏—Ä–æ–≤ –∏ –±–µ–ª–∫–æ–≤, —á—Ç–æ —è–≤–ª—è–µ—Ç—Å—è –±–æ–ª–µ–µ –≤–∞–∂–Ω—ã–º. –ü–æ—Å–∫–æ–ª—å–∫—É –∂–∏—Ä—ã –æ—Ç–≤–µ—á–∞—é—Ç –∑–∞ –≥–æ—Ä–º–æ–Ω–∞–ª—å–Ω—É—é —Å–∏—Å—Ç–µ–º—É, –∞ –±–µ–ª–∫–∏ –≤—ã—Å—Ç—É–ø–∞—é—Ç –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω–æ–≥–æ –º–∞—Ç–µ—Ä–∏–∞–ª–∞ –¥–ª—è –≤—Å–µ–≥–æ –æ—Ä–≥–∞–Ω–∏–∑–º–∞. –î–ª—è –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–º—Ñ–æ—Ä—Ç–∞ —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–µ–µ. –î–µ–ª–∞—Ç—å —á—Ç–æ-—Ç–æ –≤—Ä–æ–¥–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞, –≤ —Ç–µ—á–µ–Ω–∏–µ 3 –¥–Ω–µ–π –ø—Ä–∏–¥–µ—Ä–∂–∏–≤–∞—Ç—å—Å—è –¥–∞–Ω–Ω–æ–π –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏, –∑–∞—Ç–µ–º –æ–¥–∏–Ω –¥–µ–Ω—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â—É—é:
        \n- {round(target_weight * 1.2)} –≥ –∂–∏—Ä–æ–≤;
        \n- {round(target_weight * 1.5)} –≥ –±–µ–ª–∫–æ–≤;
        \n- {round(target_weight * 2)} –≥ —É–≥–ª–µ–≤–æ–¥–æ–≤.
        \n–ö–∞–ª–æ—Ä–∏–π–æ–Ω–æ—Å—Ç—å –±—É–¥–µ—Ç —Ç–æ–π –∂–µ, –Ω–æ –≤ —ç—Ç–æ—Ç –¥–µ–Ω—å –º—ã —Å–Ω–∏–∑–∏–º –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –±–µ–ª–∫–∞ –∏ –ø–æ–≤—ã—Å–∏–º –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ —É–≥–ª–µ–≤–æ–¥–æ–≤.
        \n–ü–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ —Ü–µ–ª–µ–≤–æ–≥–æ –≤–µ—Å–∞, –º–æ–∂–µ—à—å –æ–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏ —è –ø—Ä–æ–∏–∑–≤–µ–¥—É –ø–µ—Ä–µ—Ä–∞—Å—á–µ—Ç –ø–æ–¥ –Ω–æ–≤—É—é —Ü–µ–ª—å. 
        \n –£–¥–∞—á–∏! –í—Å–µ –ø–æ–ª—É—á–∏—Ç—Å—è ‚ò∫Ô∏è
        ''')
        send_keyboard(msg)
def delete_last(msg):
    with sqlite3.connect('fit_o_bot.db') as con:
        cursor = con.cursor()
        cursor.execute(f'DELETE FROM users_weights_table WHERE user_id=={msg.from_user.id} ORDER BY ID DESC LIMIT 1')
        bot.send_message(msg.chat.id, '–ü—Ä–æ—à–ª–æ —É—Å–ø–µ—à–Ω–æ!')
        send_keyboard(msg, "–ß–µ–º –µ—â–µ –º–æ–≥—É –ø–æ–º–æ—á—å?")
def delete_all(msg):
    with sqlite3.connect('fit_o_bot.db') as con:
        cursor = con.cursor()
        cursor.execute(f'DELETE FROM users_weights_table WHERE user_id=={msg.from_user.id}')
        con.commit()
    bot.send_message(msg.chat.id, '–ò –Ω–∞—á–Ω–µ–º –≤—Å–µ —Å —á–∏—Å—Ç–æ–≥–æ –ª–∏—Å—Ç–∞! ü•Ç')
    send_keyboard(msg, "–ß–µ–º –µ—â–µ –º–æ–≥—É –ø–æ–º–æ—á—å?")
def callback_worker(call):
    if call.text == "–•–æ—á—É —Å–æ–æ–±—â–∏—Ç—å —Å–≤–æ–π —Ç–µ–∫—É—â–∏–π –≤–µ—Å üò±":
        msg = bot.send_message(call.chat.id, '''
            –ù–µ –±–æ–π—Å—è, –æ—Ç–ø—Ä–∞–≤–ª—è–π —Å–≤–æ–π —Ç–µ–∫—É—â–∏–π –≤–µ—Å, –Ω–∞ —Å–≤–æ–µ–º –≤–µ–∫—É —è –≤–∏–¥–∞–ª –º–Ω–æ–≥–æ–µ..
        –ü—Ä–∏—Å—ã–ª–∞–π –≤ —Ñ–æ—Ä–º–∞—Ç–µ —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã –∏ –≤–µ—Å–∞ —Ä–∞–∑–¥–µ–ª–µ–Ω–Ω—ã—Ö –ø—Ä–æ–±–µ–ª–æ–º, –º–Ω–µ –Ω—É–∂–Ω–æ –∑–∞–ø–∏—Å–∞—Ç—å —ç—Ç–æ –≤ —Å–≤–æ–π –∂—É—Ä–Ω–∞–ª:)
        –ù–∞–ø—Ä–∏–º–µ—Ä: 05.12.2021 87.77 (–≥–¥–µ –ø–µ—Ä–≤–∞—è —á–∞—Å—Ç—å - –¥–∞—Ç–∞, –∞ –≤—Ç–æ—Ä–∞—è - –≤–µ—Å).''')
        bot.register_next_step_handler(msg, add_weight)

    elif call.text == "–•–æ—á—É –ø–æ–¥–Ω–∞–±—Ä–∞—Ç—å –º–∞—Å—Å—ã üí™":
        try:
            increase_weight(call)
        except:
            bot.send_message(call.chat.id, '–ö–∞–∂–µ—Ç—Å—è, –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ —Ç–≤–æ–µ–º –≤–µ—Å–µ, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–Ω–∞—á–∞–ª–∞ –∏—Ö –≤–≤–µ—Å—Ç–∏ üòõ')
            send_keyboard(call, "–ß–µ–º –µ—â–µ –º–æ–≥—É –ø–æ–º–æ—á—å?")

    elif call.text == "–•–æ—á—É —Å–æ–≥–Ω–∞—Ç—å –∂–∏—Ä–æ–∫ ü•¶":
        try:
            decrease_weight(call)
        except:
            bot.send_message(call.chat.id, '–ö–∞–∂–µ—Ç—Å—è, –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ —Ç–≤–æ–µ–º –≤–µ—Å–µ, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–Ω–∞—á–∞–ª–∞ –∏—Ö –≤–≤–µ—Å—Ç–∏ üòõ')
            send_keyboard(call, "–ß–µ–º –µ—â–µ –º–æ–≥—É –ø–æ–º–æ—á—å?")

    elif call.text == "–•–æ—á—É –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Å–≤–æ–µ–≥–æ –≤–µ—Å–∞ üòà":
        try:
            weight_statistic(call)
        except:
            bot.send_message(call.chat.id, '–ö–∞–∂–µ—Ç—Å—è, –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ —Ç–≤–æ–µ–º –≤–µ—Å–µ, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–Ω–∞—á–∞–ª–∞ –∏—Ö –≤–≤–µ—Å—Ç–∏ üòõ')
            send_keyboard(call, "–ß–µ–º –µ—â–µ –º–æ–≥—É –ø–æ–º–æ—á—å?")
    elif call.text == "–£–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é –∑–∞–ø–∏—Å—å –≤–µ—Å–∞":
        try:
            delete_last(call)
        except:
            bot.send_message(call.chat.id, '–ö–∞–∂–µ—Ç—Å—è, –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ —Ç–≤–æ–µ–º –≤–µ—Å–µ, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–Ω–∞—á–∞–ª–∞ –∏—Ö –≤–≤–µ—Å—Ç–∏ üòõ')
            send_keyboard(call, "–ß–µ–º –µ—â–µ –º–æ–≥—É –ø–æ–º–æ—á—å?")
    elif call.text == "–£–¥–∞–ª–∏—Ç—å –≤—Å–µ –∑–∞–ø–∏—Å–∏":
        try:
            delete_all(call)
        except:
            bot.send_message(call.chat.id, '–ö–∞–∂–µ—Ç—Å—è, –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ —Ç–≤–æ–µ–º –≤–µ—Å–µ, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–Ω–∞—á–∞–ª–∞ –∏—Ö –≤–≤–µ—Å—Ç–∏ üòõ')
            send_keyboard(call, "–ß–µ–º –µ—â–µ –º–æ–≥—É –ø–æ–º–æ—á—å?")
@bot.message_handler(content_types=['text'])
def handle_docs_audio(message):
    send_keyboard(message, text="–Ø –Ω–µ –ø–æ–Ω–∏–º–∞—é :-( –í—ã–±–µ—Ä–∏ –æ–¥–∏–Ω –∏–∑ –ø—É–Ω–∫—Ç–æ–≤ –º–µ–Ω—é:")
bot.infinity_polling()
